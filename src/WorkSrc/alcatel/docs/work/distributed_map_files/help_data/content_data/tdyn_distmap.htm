<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us"><head>

<script>if( self == top ){ window.location.replace( "../../../../../?topic=/com.ibm.websphere.base.doc/info/aes/ae/tdyn_distmap.html");}</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta content="public" name="security">
<meta content="index,follow" name="Robots">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;http://www.icra.org/ratingsv02.html&quot; l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) &quot;http://www.rsac.org/ratingsv01.html&quot; l gen true r (n 0 s 0 v 0 l 0) &quot;http://www.classify.org/safesurf/&quot; l gen true r (SS~~000 1))">
<meta content="task" name="DC.Type">
<meta name="DC.Title" content="Using the DistributedMap and DistributedObjectCache interfaces for the dynamic cache">
<meta name="abstract" content="By using the DistributedMap or DistributedObjectCache interfaces, Java 2 platform, Enterprise Edition (J2EE) applications and system components can cache and share Java objects by storing a reference to the object in the cache.">
<meta name="description" content="By using the DistributedMap or DistributedObjectCache interfaces, Java 2 platform, Enterprise Edition (J2EE) applications and system components can cache and share Java objects by storing a reference to the object in the cache.">
<meta content="dynacache" name="DC.Coverage">
<meta scheme="URI" name="DC.Relation" content="tdyn_dynamiccache.html">
<meta scheme="URI" name="DC.Relation" content="udyn_cacheinstancescollection.html">
<meta scheme="URI" name="DC.Relation" content="udyn_cacheinstances.html">
<meta scheme="URI" name="DC.Relation" content="tdyn_enablecache.html">
<meta scheme="URI" name="DC.Relation" content="tdyn_diskoffload.html">
<meta scheme="URI" name="DC.Relation" content="rdyn_tunediskcache.html">
<meta scheme="URI" name="DC.Relation" content="cdyn_invalidationlisteners.html">
<meta scheme="URI" name="DC.Relation" content="cdyn_cacheinstances.html">
<meta scheme="URI" name="DC.Relation" content="tdyn_cacheinstances.html">
<meta content="programming" name="DC.Audience.Job">
<meta content="programmer" name="DC.Audience.Type">
<meta content="programmer" name="DC.Audience.Type">
<meta name="prodname" content="IBM WebSphere Application Server">
<meta content="6" name="version">
<meta content="0" name="release">
<meta content="2" name="modification">
<meta name="platform" content="Distributed operating systems">
<meta name="copyright" content="IBM Corporation 2004, 2006">
<meta name="DC.Rights.Owner" content="IBM Corporation 2004, 2006">
<meta content="XHTML" name="DC.Format">
<meta content="tdyn_distmap" name="DC.Identifier">
<meta content="en-us" name="DC.Language"><!-- All rights reserved. Licensed Materials Property of IBM --><!-- US Government Users Restricted Rights --><!-- Use, duplication or disclosure restricted by --><!-- GSA ADP Schedule Contract with IBM Corp. -->




<link href="tdyn_distmap_data/ibmdita.css" type="text/css" rel="stylesheet">
<link href="tdyn_distmap_data/swg_info_common.css" type="text/css" rel="stylesheet">
<link href="tdyn_distmap_data/monospace.css" type="text/css" rel="stylesheet" disabled=""><title>Using the DistributedMap and DistributedObjectCache interfaces for the dynamic cache</title>

<style type="text/css">
        span.stealth { visibility:hidden; }
   </style></head><body id="tdyn_distmap"><a name="tdyn_distmap"><!-- --></a>
<img style="border: 0pt none ; vertical-align: middle;" alt="WebSphere" src="tdyn_distmap_data/IC-ws-sm.gif"> <span class="runningheader"><strong>Application Server, Version 6.0.x</strong>&nbsp;&nbsp;&nbsp;Operating Systems: <strong>AIX, HP-UX, Linux, Solaris, Windows</strong></span><br><hr align="left">
<h1 class="topictitle1">Using the DistributedMap and DistributedObjectCache interfaces for
the dynamic cache</h1>




<div><p>By using the DistributedMap or DistributedObjectCache interfaces,
Java 2 platform, Enterprise Edition  (J2EE) applications and system components
can cache and share Java objects by storing a reference to the object in the
cache. </p>

<div class="p"><h4 class="sectiontitle">Before you begin</h4>Enable the dynamic cache service. See <a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/tdyn_enablecache.html">Enabling the dynamic cache service 
</a> for more information.</div>

<div class="section"><h4 class="sectiontitle">About this task</h4><p>The DistributedMap and DistributedObjectCache interfaces are simple
interfaces for the dynamic cache. Using these interfaces, J2EE applications
and system components can cache and share Java objects by storing a reference
to the object in the cache. The default dynamic cache instance is created
if the dynamic cache service is enabled in the administrative console. This
default instance is bound to the global Java Naming and Directory Interface
(JNDI) namespace using the name services/cache/distributedmap. </p>
<p>Multiple
instances of the DistributedMap and DistributedObjectCache interfaces on the
same Java virtual machine (JVM) enable applications to separately configure
cache instances as needed. Each instance of the DistributedMap interface has
its own properties that can be set using <a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/udyn_cacheinstancescollection.html">Object cache instance settings
</a>. </p>
<div class="p"><div class="tip"><span class="tiptitle">Tip:</span> For
more information about the DistributedMap and  DistributedObjectCache interfaces,
see the API documentation for the com.ibm.websphere.cache package. See <a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/welc_ref_dev_javadoc.html">Reference: Generated API documentation
</a> for
more information.</div>
</div>
<div class="important"><span class="importanttitle">Important:</span> If you
are using custom object keys, you must place your classes in a shared library.
You can define the shared library at cell, node, or server level. Then, in
each server create a class loader and associate it with the shared library
that you defined. See <a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/tcws_sharedlib.html">Managing shared libraries
</a> and <a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/urun_rclassloader_inst.html">Class loader settings
</a> for
more information.<p>Place JAR files in a shared library when you deploy the
application in a cluster with replication enabled. Simply turning on replication
does not require a shared library; however, if you are using application-specific
Java objects, such as cache key or cache value, those Java classes are required
to be in the shared library. If those values are not in a shared library,
you will get ClassNotFound exceptions when the data replication
service (DRS) attempts to deserialize those objects on the receiving side.</p>
</div>
There are three
methods for configuring and using cache instances.</div>

<h4 class="sectiontitle">Procedure</h4><ul>
<li class="stepexpand"><span><strong>Method 1 - Administrative console</strong> </span>  You can create
additional cache instances using the administrative console.
<ol>
<li><span>In the administrative console, select <strong>Resources &gt; Object
cache instances</strong> and create a new object cache instance.</span></li>

</ol>

 <div class="p">If you defined two object cache instances in the administrative console
with JNDI names of <strong>services/cache/instance_one</strong> and <strong>services/cache/instance_two</strong>,
you can use the following code to look up the cache instances:<pre> InitialContext ic = new InitialContext();
DistributedMap dm1 = (DistributedMap)ic.lookup("services/cache/instance_one");

DistributedMap dm2 = (DistributedMap)ic.lookup("services/cache/instance_two");

// or

InitialContext ic = new InitialContext();
DistributedObjectCache dm1 = (DistributedObjectCache)ic.lookup("services/cache/instance_one");

DistributedObjectCache dm2 = (DistributedObjectCache)ic.lookup("services/cache/instance_two");
</pre>
</div>
</li>

<li class="stepexpand"><span><strong>Method 2 - Properties file</strong> </span>  You can create cache
instances using the <tt>cacheinstances.properties</tt> file and package the
file in your Enterprise Archive (EAR) file. <div class="p">Following is an example of
how you can create additional cache instances using the <tt>cacheinstances.properties</tt> file:<pre>cache.instance.0=/services/cache/instance_one

cache.instance.0.cacheSize=1000

cache.instance.0.enableDiskOffload=true

cache.instance.0.diskOffloadLocation=${app_server_root}/diskOffload

cache.instance.0.flushToDiskOnStop=true

cache.instance.0.useListenerContext=true

cache.instance.0.enableCacheReplication=false

cache.instance.0.disableDependencyId=false

cache.instance.0.htodCleanupFrequency=60

cache.instance.1=/services/cache/instance_two

cache.instance.1.cacheSize=1500

cache.instance.1.enableDiskOffload=false

cache.instance.1.flushToDiskOnStop=false

cache.instance.1.useListenerContext=false

cache.instance.1.enableCacheReplication=true

cache.instance.1.replicationDomain=DynaCacheCluster

cache.instance.1.disableDependencyId=true</pre>
</div>
<p>The preceding example
creates two cache instances named <tt>instance_one</tt> and <tt>instance_two</tt>. <tt>instance_one</tt> has
a cache entry size of 1,000 and <tt>instance_two</tt> has a cache entry size
of 1,500. Disk offload is enabled in <tt>instance_one</tt> and disabled in <tt>instance_two</tt>.
Use listener context is enabled in <tt>instance_one</tt> and disabled in <tt>instance_two</tt>.
Flush to disk on stop is enabled in <tt>instance_one</tt> and disabled in <tt>instance_two</tt>.
Cache replication is enabled in <tt>instance_two</tt> and disabled in <tt>instance_one</tt>.
The name of the data replication domain for <tt>instance_two</tt> is DynaCacheCluster.
Dependency ID support is disabled in <tt>instance_two</tt>.</p>
<div class="p">You must
place the <tt>cacheinstances.properties</tt> file in either your application
server or application class path. For example, you can use your application <tt>WAR</tt> file, <tt>WEB-INF\classes</tt> directory,
or <tt>was_root\classes</tt> directory. The first entry in the properties
file (<tt>cache.instance.0</tt>) specifies the JNDI name for the cache instance
in the global namespace. You can use the following code to look up the cache
instance:      <pre>     InitialContext ic = new InitialContext();
     DistributedMap dm1 = (DistributedMap)ic.lookup("services/cache/instance_one");
     DistributedMap dm2 = (DistributedMap)ic.lookup("services/cache/instance_two");</pre>
For
more information about the DistributedMap and DistributedObjectCache interfaces,
see the API documentation for the <tt>com.ibm.websphere.cache</tt> package.</div>

</li>

<li class="stepexpand"><span><strong>Method 3 - Resource references</strong></span> <div class="note"><span class="notetitle">Note:</span> Method
three is an extension to method one or method two, listed above. First use
either method one or method two. </div>
<div class="p">Define a resource-ref in your module
deployment descriptor (<tt>web.xml</tt> and <tt>ibm-web-bnd.xmi</tt> files)
and look up the cache using the <tt>java:comp</tt> namespace.<pre><strong>Resource-ref example:
File: web.xml</strong>
&lt;resource-ref id="ResourceRef_1"&gt;
  &lt;res-ref-name&gt;dmap/LayoutCache&lt;/res-ref-name&gt;
  &lt;res-type&gt;com.ibm.websphere.cache.DistributedMap&lt;/res-type&gt;
  &lt;res-auth&gt;Container&lt;/res-auth&gt;
  &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;
&lt;/resource-ref&gt;
&lt;resource-ref id="ResourceRef_2"&gt;
  &lt;res-ref-name&gt;dmap/UserCache&lt;/res-ref-name&gt;
  &lt;res-type&gt;com.ibm.websphere.cache.DistributedMap&lt;/res-type&gt;
  &lt;res-auth&gt;Container&lt;/res-auth&gt;
  &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;
&lt;/resource-ref&gt;

<strong>File: ibm-web-bnd.xmi</strong>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;webappbnd:WebAppBinding xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" 
xmlns:webappbnd="webappbnd.xmi" 
xmlns:webapplication="webapplication.xmi" xmlns:commonbnd="commonbnd.xmi" 
xmlns:common="common.xmi" 
xmi:id="WebApp_ID_Bnd" virtualHostName="default_host"&gt;
  &lt;webapp href="WEB-INF/web.xml#WebApp_ID"/&gt;
  &lt;resRefBindings xmi:id="ResourceRefBinding_1" jndiName="services/cache/instance_one"&gt;
    &lt;bindingResourceRef href="WEB-INF/web.xml#ResourceRef_1"/&gt;
  &lt;/resRefBindings&gt;
  &lt;resRefBindings xmi:id="ResourceRefBinding_2" jndiName="services/cache/instance_two"&gt;
    &lt;bindingResourceRef href="WEB-INF/web.xml#ResourceRef_2"/&gt;
  &lt;/resRefBindings&gt;
&lt;/webappbnd:WebAppBinding&gt;</pre>
The following example shows how to look
up the resource-ref: <pre>InitialContext ic = new InitialContext();
  DistributedMap dm1a =(DistributedMap)ic.lookup("java:comp/env/dmap/LayoutCache");
  DistributedMap dm2a =(DistributedMap)ic.lookup("java:comp/env/dmap/UserCache");
// or
  DistributedObjectCache dm1a =(DistributedObjectCache)ic.lookup("java:comp/env/dmap/LayoutCache");
  DistributedObjectCache dm2a =(DistributedObjectCache)ic.lookup("java:comp/env/dmap/UserCache");</pre>
The
previous resource-ref example maps <tt>java:comp/env/dmap/LayoutCache</tt> to <tt>/services/cache/instance_one</tt> and <tt>java:comp/env/dmap/UserCache</tt> to <tt>/services/cache/instance_two</tt>. In the examples, <tt>DistributedMap
dm1</tt> and <tt>dm1a</tt> are the same object. <tt>DistributedMap dm2</tt> and <tt>dm2a</tt> are
the same object.</div>
<div class="p"><div class="restriction"><span class="restrictiontitle">Restriction:</span> DistributedMap and DistributedObjectCache
do not  have authorization or access control associated with the  cache entries.</div>
</div>

</li>

</ul>


</div>

<br><br><hr align="left"><div><div class="relinfo"><strong>Sub-topics</strong><br>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/udyn_cacheinstancescollection.html">Object cache instance settings
</a><br>
</div>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/udyn_cacheinstances.html">Object cache instance collection
</a><br>
</div>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/cdyn_invalidationlisteners.html">Invalidation listeners
</a><br>
</div>

</div>

<div class="familylinks">
</div>
<div class="relconcepts"><strong>Related concepts</strong><br>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/cdyn_cacheinstances.html">Cache instances
</a></div>
</div>
<div class="reltasks"><strong>Related tasks</strong><br>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/tdyn_enablecache.html">Enabling the dynamic cache service 
</a></div>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/tdyn_diskoffload.html">Configuring dynamic cache disk offload
</a></div>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/tdyn_cacheinstances.html">Using object cache instances
</a></div>
<a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/tdyn_dynamiccache.html">Task overview: Using the dynamic cache service to improve performance
</a></div>
<div class="relref"><strong>Related reference</strong><br>
<div><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/aes/ae/rdyn_tunediskcache.html">Managing cache entries stored on a disk
</a></div>
</div>
</div>
<span class="runningfooter"><img style="border: 0pt none ;" alt="" src="tdyn_distmap_data/task_obj.gif"> <strong>Task topic</strong></span>
      &nbsp;&nbsp;&nbsp;
   <br><hr align="left"><a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/topic/com.ibm.websphere.base.doc/info/terms_of_use.html" class="runningfooter"><strong>Terms of Use</strong></a> |
<a target="_blank" href="mailto:wasdoc@us.ibm.com" class="runningfooter"><strong>Feedback</strong></a>
<br><br><img style="border: 0pt none ;" alt="" src="tdyn_distmap_data/timestamp.gif"><span class="runningfooter">Last updated: Jun 27, 2006 1:49:57 PM CDT </span><br>
<span class="runningfooter">http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/index.jsp?topic=/com.ibm.websphere.base.doc/info/aes/ae/tdyn_distmap.html</span><br><br>
<span class="runningfooter">
      © Copyright IBM Corporation 2004, 2006. All Rights Reserved.<br>This information center is powered by Eclipse technology.  (http://www.eclipse.org)
</span></body></html>