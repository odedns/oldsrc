<?xml version="1.0" encoding="UTF-8"?>
<!--DOCTYPE dseoper.xml SYSTEM "../../dtd/dseoper.dtd"-->
<dseoper.xml>
	<!--DWGroupDef:Server.Operations-->
	<!-- SERVER OPERATION DEFs.================================================= -->
	<!--=========================================================================-->
	<!-- Java StartUp Operation                                                  -->
	<!--=========================================================================-->
	<operation context="startupServerCtx" id="startupServerOp" implClass="mataf.operations.StartupServerOp">
		<refFormat name="csReplyFormat" refId="startupReplyFmt" />
	</operation>
	
	<operation context="endSessionServerCtx" id="endSessionServerOp" implClass="mataf.operations.EndSessionServerOp" />
	
	<operation context="startupServerCtx" id="tablesLoaderServerOp">
		<opStep id="startUpTablesLoader"
				implClass="mataf.general.operations.StartUpTablesLoaderOpStep" />
		
		<opStep id="initPersonalMenuOpStep"
				implClass="mataf.personalmenu.operationsteps.InitPersonalMenuOpStep" />
				
		<refFormat name="csReplyFormat" refId="tablesLoaderReplyFmt" />
	</operation>
	<!--=========================================================================-->
	<!-- DO NOT MODIFY !!! Event Manager Operation                               -->
	<!--=========================================================================-->
	<com.ibm.dse.base.EventManagerServerOperation id="eventManagerServerOperation" implClass="com.ibm.dse.base.EventManagerServerOperation" />

	<!--=========================================================================-->
	<!-- test trx server Operation                                               -->
	<!--=========================================================================-->
	<!--operation context="testTrxCtx" id="testTrxServerOp" implClass="mataf.operations.TestTrxServerOp">
		<refFormat name="csReplyFormat" refId="testTrxReplyFmt" />
		<refFormat name="hostSendFormat" refId="testTrxSendHostFmt" />
		<refFormat name="hostReceiveFormat" refId="testTrxReceiveHostFmt" />
	</operation-->
	
	<operation context="testTrxCtx" id="testTrxServerOp" implClass="mataf.operations.TestIcollServerOp">
		<refFormat name="csReplyFormat" refId="testTrxReplyFmt" />
	</operation>
	
	<!--=========================================================================-->
	<!-- flow processor test server Operation                                               -->
	<!--=========================================================================-->
	<!--operation context="testTrxCtx" id="flowServerOp" implClass="tests.FlowServerOp">
		<refFormat name="csReplyFormat" refId="testTrxReplyFmt" />		
	</operation-->

	<!--  reference tables server operation -->
	<operation context="refTablesCtx" id="refTablesServerOp" implClass="mataf.services.reftables.RefTablesServerOp">
	</operation>

	<!-- generic server operation -->
	<operation context="genOpCtx" id="genericSrvOp" implClass="mataf.operations.general.GenericSrvOp">
		<refFormat name="csReplyFormat" refId="genReplyFmt" />
	</operation>
	<!-- test operation -->
	<operation context="testTrxCtx" id="serverOp" implClass="tests.ServerOp"></operation>
	
	<!-- CICS test operation -->
	<operation context="cicsTestServerCtx" id="cicsTestServerOp" implClass="tests.CicsTestServerOp"/>
	
	<!--=========================================================================-->
	<!-- JDBC Server Operation                                               -->
	<!--=========================================================================-->
	<operation context="JDBCCtx" id="JDBCServerOp" implClass="mataf.operations.JDBCServerOp">
		<!--refFormat name="csReplyFormat" refId="testTrxReplyFmt" /-->		
	</operation>
	
	<!--=========================================================================-->
	<!-- Journal Server Operation                                               -->
	<!--=========================================================================-->
	<operation context="journalOpCtx" id="journalServerOp" implClass="mataf.operations.JournalServerOp"></operation>

	<operation context="journalOpCtx" id="journalWithStepsServerOp">
		<opStep id="writeToJournalOpStep" implClass="mataf.common.operationsteps.WriteToJournalOpStep" on1Do="return" />
	</operation>

	<!--=========================================================================-->
    <!-- Personal Menu server operations                                         -->
    <!--=========================================================================-->    
    <operation	context="emptyCtxChainedToBranchCtx" id="addTrxToPersonalMenuSlServerOp">
    	<opStep id="addRecordToTableOpStep"
    			serviceName="PERSONAL_MENU"
    			formatName="personalMenuTableFmt" />
    				    	
    	<refFormat refId="personalMenuCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="emptyCtxChainedToBranchCtx" id="removeTrxFromPersonalMenuSlServerOp">
    	<opStep id="removeTrxFromPersonalMenuOpStep"
    			implClass="mataf.personalmenu.operationsteps.RemoveTrxFromPersonalMenuOpStep" />
    				    	
    	<refFormat refId="personalMenuCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
	<!--=========================================================================-->
    <!-- T410 server operations                                                  -->
    <!--=========================================================================-->
    
    <operation	context="slikaCtx" id="initSlikaServerOp">
    	<opStep id="setMaxCheckAmmountFieldOpStep"
    			implClass="mataf.general.operations.SetFieldValueFromTableOpStep"
    			fieldToSet="maxAmmount4check" 
    			tableName="CHST_GLBL" 
    			tableKey="CH_MAX_SCHUM_TLR" />
    			
    	<opStep id="initTrxQueries"
    			implClass="mataf.general.operations.InitTrxQueries"/>
    				    	
    	<refFormat refId="initSlikaCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <opStepsKColl id="restrictedAccountsChecksFlow">
    	<opStep id="restrictedAccount016000013ValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL602" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	<opStep id="restrictedAccount980000009ValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL602" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	<opStep id="restrictedAccount970000189ValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL622" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	<opStep id="restrictedAccount970ValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL604" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	<opStep id="restrictedAccount960881026ValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL627" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	<opStep id="restrictedAccount960990305ValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL600" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	<opStep id="restrictedAccountKupotGemelValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL601" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	<opStep id="restrictedAccountBiyulValidationOpStep" 
    			branchFieldName="BranchIdInput"
    			fieldName2check="AccountNumber" 
    			errorNo="TL602" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    </opStepsKColl>
    
    <!-- The next opSteps are general handle of field named 'GL_KOD_TIPUL' returned from host -->
    <opStepsKColl id="kodTipulKlaliFlow">    
    	<!-- If kodTipul='M' then set message concerning manager aproval -->
    	<opStep id="setMsgAccordingToValueMOpStep" 
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			errorNo="GL211" 
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="M" />
    			
    	<!-- If kodTipul='R' then set message concerning communication -->
    	<opStep id="setMsgAccordingToValueROpStep"  
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			errorNo="GL204" 
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="R" />
    			
    	<!-- If kodTipul='I' then set message concerning data on host -->
    	<opStep id="setMsgAccordingToValueIOpStep" 
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			errorNo="GL211" 
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="I" />
    			
    	<!-- If kodTipul='N' then set message to try again -->		
    	<opStep id="setMsgAccordingToValueNOpStep"  
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			errorNo="GL234" 
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="N" />
    			
    	<!-- If kodTipul='Q' then set message concerning the clerk -->
    	<opStep id="setMsgAccordingToValueQOpStep" 
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			errorNo="AL079" 
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="Q" />
    </opStepsKColl>
    
    <opStepsKColl id="accountBalancePropertiesCheckFlow">
    	<opStep id="checkKodIfyunUnusedAccountOpStep"
    			implClass="mataf.slika.operations.CheckKodIfyunUnusedAccountOpStep" 
    			errorNo="TL653"
    			on0Do="moneyLaunderyCheckOpStep" />
    	<opStep id="accountBalanceDataSetterOpStep" />
    	<opStep id="accountPropertiesSetterOpStep" 
    			implClass="mataf.slika.operations.AccountPropertiesSetterOpStep" />
    	<opStep id="moneyLaunderyCheckOpStep" 
    			errorNo="TL245" />
    	<opStep id="unusedAccountCheckOpStep" 
    			errorNo="TL126" 
    			on1Do="return" />
    	<opStep id="riskyAccountCheckOpStep" 
    			errorNo="TL064" 
    			on1Do="return" />
    	<opStep id="frozenAccountCheckOpStep" 
    			errorNo="TL065" 
    			on1Do="return" />
    	<opStep id="confiscatedAccountCheckOpStep" 
    			errorNo="TL066" 
    			on1Do="return" />
    	<opStep id="limitedAccountCheckOpStep" 
    			errorNo="TL067" 
    			on1Do="return" />
    	<opStep id="rejectedChequeCheckOpStep" 
    			errorNo="TL068" 
    			on1Do="return" />
    </opStepsKColl>
    
    <opStepsKColl id="giluyNaotFlow">
    	
    	<!-- Check if should commit this flow -->
    	<opStep id="isDanachMsgNeeded" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="GiluyNaotData.isShowDanachMsg" 
    			value2cmpr="0" 
    			on0Do="setMsgAccordingToChargeCommissionValue1"/>
    	
    	<!-- If danach type is different from MATI & MATACH then do'nt commit this flow -->		
    	<opStep id="checkMatiDanachType" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="GiluyNaotData.danachType" 
    			value2cmpr="1" 
    			on0Do="setReturnParamsAccordingToGlstGlblOpStep"/>
    	<opStep id="checkMatachDanachType" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="GiluyNaotData.danachType" 
    			value2cmpr="2" 
    			on1Do="return"/>		
    	
    	
    	<!-- Set the return parameters according to the parameters sent to this flow 
    		 & the data retrived from table GLST_GLBL -->
    	<opStep id="setReturnParamsAccordingToGlstGlblOpStep"
    			implClass="mataf.general.operations.SetReturnParamsAccordingToGlstGlblOpStep" />
    	
    	<!-- If should charge commission then show the appropriate message -->
    	<opStep id="setMsgAccordingToChargeCommissionValue1" 
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			fieldNameToCmpr="GiluyNaotData.commissionType" 
    			value2cmpr="1" 
    			errorNo="GL941"/>
    	
    	<!-- If should check commission then show the appropriate message -->
    	<opStep id="setMsgAccordingToChargeCommissionValue2" 
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			fieldNameToCmpr="GiluyNaotData.commissionType" 
    			value2cmpr="2" 
    			errorNo="GL942"/>
    </opStepsKColl>
    
    <operation	context="slikaCtx" id="checkAccountSlServerOp">
    			
    	<!-- tipul be cheshbonot asurim -->
    	<refOpSteps refId="restrictedAccountsChecksFlow"/>
    	
    	<!-- tipul be cheshbonot revach ve hefsed -->
    	<opStep id="accountExistenceInTLSTSCHAOpStep" 
    			fieldName2check="AccountNumber" 
    			accountTypeFieldName="AccountType" 
    			on0Do="accountNumberModuluCheckOpStep" />
    	<opStep id="accountIfyunSnifValidationOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="TL605" 
    			on1Do="return"/>
    			
    	<!-- bdikat modulu le cheshbon -->
    	<opStep id="accountNumberModuluCheckOpStep" 
    	    	fieldName2check="AccountNumber" 
    	    	errorNo="GL262" 
    	    	accountTypeFieldName="AccountType" 
    	    	on1Do="return" />
    	    	
    	<!-- bdikat zminut cheshbon -->
    	<opStep id="accountAvailabilityCheckOpStep" 
    			fieldName2check="AccountNumber" 
    			errorNo="GL101" 
    			accountTypeFieldName="AccountType" 
    			on1Do="return" />
    	
    	<!-- the next 2 opSteps are 4 debuging only -->
    	<!--opStep id="hostReplyTestParamsSetterOpStep" /-->
    			
    	<opStep id="dataMapperOpStep" 
    			dataMapperName="AccountBalanceTrx_MapperFmt" 
    			on1Do="return" />
    	<opStep id="sendHostSynchronousOpStep" on1Do="return" />
    	<opStep id="hostMessageSetterOpStep" on1Do="return" />
    	<refOpSteps refId="kodTipulKlaliFlow"/>
    	    	    	
    	<!-- tipul le kod tipul be netuney itrot le slika-->
    	<opStep id="setMsgAccordingToValueXOpStep" 
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="X" 
    			errorNo="TL652" 
    			on1Do="return" />
    	<opStep id="checkKodTipulEOpStep"
    			implClass="mataf.slika.operations.CheckKodTipulEOpStep"
    			fieldName2check="AccountNumber" 
    			field2setText="AccountBalance.OwnerName" 
    			errorNo="AH033"
    			on1Do="setIshurMenahelOpStep"/>
    	<opStep id="checkKodTipulLOpStep"  
    			implClass="mataf.slika.operations.CheckKodTipulLOpStep"
    			fieldName2check="AccountNumber" 
    			field2setText="AccountBalance.OwnerName" 
    			errorNo="GL235"
    			on1Do="setIshurMenahelOpStep"/>
    	<opStep id="checkKodTipulNQROpStep" 
    			implClass="mataf.slika.operations.CheckKodTipulNQROpStep"
    			on1Do="return" 
    			on0Do="t410ViewSetter4AccountBalanceOpStep"
    			fieldName2check="AccountNumber" errorNo="AH033" field2setText="AccountBalance.OwnerName" 
    			accountTypeFieldName="AccountType" branchFieldName="BranchIdInput" />
    	
    	<opStep id="setIshurMenahelOpStep"
    			implClass="mataf.general.operations.FieldValueSetterOpStep"
    			fieldToSet="shouldRequestIshurMenahel" valueToSet="true" />
    			
    	<!-- arichat sadot ba masach -->
    	<opStep id="t410ViewSetter4AccountBalanceOpStep" 
    			implClass="mataf.slika.operations.T410ViewSetter4AccountBalanceOpStep" />
    	    	
    	<!-- bdikat mazav lakoch -->
    	<opStep id="checkMazavLakochNoDataOpStep" on1Do="moneyLaunderyCheckOpStep" 
    			fieldToSet="AccountBalance.OwnerName" errorNo="AH033" />
    	<opStep id="checkMazavLakochHostErrorOpStep" on1Do="moneyLaunderyCheckOpStep" 
    			errorNo="TL607" />
    	<opStep id="checkMazavLakochFileNotAvlblOpStep" 
    			errorNo="TL608" />	
    			
    	<refOpSteps refId="accountBalancePropertiesCheckFlow"/>
    			
    	<!-- arichat sadot behet-em le sug hacheshbon -->
    	<opStep id="privateAccountCheckOpStep" />
    	
    	<!-- arichat cheshbonot le hachzara -->
    	<opStep id="accountsToReturnSetterOpStep" />
    	
    	<opStep id="t410FieldsEnableOpStep"
    			implClass="mataf.slika.operations.T410FieldsEnableOpStep" />
    	
    	<!-- formats -->
    	<refFormat refId="accountValidationsCsReplyFmt" name="csReplyFormat"/>
    	<refFormat refId="accountBalanceTrxRequestFmt" name="hostSendFormat"/>
    	<refFormat refId="accountBalanceTrxReplyFmt" name="hostReceiveFormat"/>
    	<refFormat refId="AccountBalanceTrx_MapperFmt" name="AccountBalanceTrx_MapperFmt"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkTotalAmountSlServerOp">
    	<!-- set semel divuach if needed -->
    	<opStep id="checkSemelDivuachUploadOpStep" />    	   	
    	
		<refFormat refId="checkTotalAmountCsReplyFmt" name="csReplyFormat"/>
    </operation>
        
    <operation	context="slikaCtx" id="checkBranchIdServerOp">
    	<opStep id="checkExistenceInTableOpStep" 
    			fieldName2check="BeneficiaryBranchId" 
    			errorNo="GL068" 
    			tableName="GLST_SNIF" 
    			tableKey="GL_SNIF"
    			on1Do="return" />   	
    			
		<refFormat refId="checkBranchIdCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkAccountTypeServerOp">
    	<opStep id="checkExistenceInTableOpStep" 
    			fieldName2check="BeneficiaryAccountType" 
    			errorNo="GL085" 
    			tableName="GLST_SCH" 
    			tableKey="GL_SCH"
    			on1Do="return" />
    			
    	<refFormat refId="checkAccountTypeCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkReturnAccountNumberServerOp">
    	<opStep id="accountNumberModuluCheckOpStep"  
    	    	fieldName2check="BeneficiaryAccountNumber" 
    	    	errorNo="GL262" 
    	    	accountTypeFieldName="BeneficiaryAccountType" 
    	    	on1Do="return" />
    	<opStep id="returnedAccountNumberSetterOpStep" 
    			implClass="mataf.slika.operations.ReturnedAccountNumberSetterOpStep" />
    			
    	<refFormat refId="checkReturnAccountNumberCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkIdCardNumberServerOp">
    	<opStep id="checkIdCardNumberOpStep" 
    			fieldName2check="IdCardNumber" 
    			errorNo="TL609" 
    			on1Do="return" />
    	<opStep id="addMessage2MsgListOpStep" 
    			errorNo="TL227" 
    			on1Do="return" />
    	<opStep id="loanDataChangedOpStep" on1Do="return" />
    	
		<refFormat refId="checkIdCardNumberCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkMahutTashlumServerOp">
    	<opStep id="checkMahutTashlumOpStep"
    			implClass="mataf.slika.operations.CheckMahutTashlumOpStep" 
    			on1Do="return" />
    	<opStep id="loanDataChangedOpStep" on1Do="return" />
    	
		<refFormat refId="checkMahutTashlumCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="loanDataChangedServerOp">
    	<opStep id="loanDataChangedOpStep" on1Do="return" />
    	
		<refFormat refId="checkLoanNumberCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkLoanNumberServerOp">
    	<opStep id="checkTyepOfMahutTashlumOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="MahutTashlum" 
    			value2cmpr="1" 
    			on0Do="checkLoanNumberForTakbulimOpStep"
    			on1Do="checkLoanNumberForHotsaotRishoniotOpStep"/>
    	<opStep id="checkLoanNumberForHotsaotRishoniotOpStep" 
    			implClass="mataf.general.operations.CheckLoanNumberOpStep"
    			accountFieldName="AccountNumber" 
    			accountTypeFieldName="AccountType" 
    			branchFieldName="BranchIdInput"
    			errorNo="TL521" 
    			indexFieldName="LoansList_MetaData.selectedRowIndex" 
    			icoll2check="LoansList"
    			fieldName2check="loanNumber" 
    			on1Do="return" 
    			on0Do="loanDataChangedOpStep"/>    	
    	<opStep id="checkLoanNumberForTakbulimOpStep" 
    			implClass="mataf.general.operations.CheckLoanNumberOpStep"
    			errorNo="TL521" 
    			accountFieldName="AccountNumber" accountTypeFieldName="AccountType" branchFieldName="BranchIdInput"
    			fieldName2check="HotsaotRishoniotLoanNumber"
    			on1Do="return" />
    	<opStep id="loanDataChangedOpStep" on1Do="return" />
    	
		<refFormat refId="checkLoanNumberCsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkBankNumberServerOp">
    	<opStep id="checkExistenceInTableOpStep" 
    			indexFieldName="CZSS_T110_LIST_MetaData.selectedRowIndex" 
    			icoll2check="CZSS_T110_LIST"
    			fieldName2check="CH_BANK_CHOTEM" 
    			errorNo="TL614" 
    			tableName="GLST_BANK" 
    			tableKey="GL_BANK"
    			on1Do="return" />    	
    			
		<refFormat refId="CZSS_T110_LIST_CsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkBranchIdAccording2bankServerOp">
    	<opStep id="checkBranchIdAccording2bankOpStep" 
    			indexFieldName="CZSS_T110_LIST_MetaData.selectedRowIndex" 
    			icoll2check="CZSS_T110_LIST"
    			fieldName2check="CH_SNIF_CHOTEM" 
    			fieldNameToCmpr="CH_BANK_CHOTEM" 
    			errorNo="GL068"
    			on1Do="return" />   	
    			
		<refFormat refId="CZSS_T110_LIST_CsReplyFmt" name="csReplyFormat"/>
    </operation>
        
    <operation	context="slikaCtx" id="checkAccountNumber4ChequeServerOp">
    	<opStep id="checkAccountNumber4ChequeServerOpStep" 
    			indexFieldName="CZSS_T110_LIST_MetaData.selectedRowIndex" 
    			icoll2check="CZSS_T110_LIST"
    			fieldName2check="CH_CH_CHOTEM" 
    			errorNo="GL262" 
    			bankFieldName="CH_BANK_CHOTEM" 
    			on1Do="return" />    	
    			
		<refFormat refId="CZSS_T110_LIST_CsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation	context="slikaCtx" id="checkAmmountOfCheckServerOp">
    	<opStep id="checkAmmountEquals2zeroOpStep" 
    			implClass="mataf.general.operations.CompareAmmountsOpStep"
    			indexFieldName="CZSS_T110_LIST_MetaData.selectedRowIndex" 
    			icoll2check="CZSS_T110_LIST"
    			fieldName2check="CH_SCHUM_CHEQ" 
    			value2cmpr="0" 
    			comparisonType="1" 
    			errorNo="TL403" 
    			on1Do="return" />    	
    	<opStep id="checkAmmount2maxAmmountOpStep" on1Do="return"
    			implClass="mataf.general.operations.CompareAmmountsOpStep"
    			indexFieldName="CZSS_T110_LIST_MetaData.selectedRowIndex" 
    			icoll2check="CZSS_T110_LIST"
    			fieldName2check="CH_SCHUM_CHEQ"
    			fieldNameToCmpr="maxAmmount4check" 
    			comparisonType="2" 
    			errorNo="TL606" />
    			
		<refFormat refId="CZSS_T110_LIST_CsReplyFmt" name="csReplyFormat"/>
    </operation>
    
    <operation context="slikaCtx" id="checkLoanDetailsServerOp">
    	<!-- 1st check if hostaot rishoniyot or takbolim is selected - continue in the flow according to result -->
    	<opStep id="checkMahutTashlumTypeOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="MahutTashlum" 
    			value2cmpr="1" 
    			on0Do="compareTotalAmountsForHotsaotRishoniyotOpStep" 
    			on1Do="next"/>
    	
    	<!-- Flow for takbulim selection -->
    	<opStep id="compareTotalAmountsOpStep" 
    			fieldName2check="TotalAmount" 
    			errorNo="TL610" 
    			icoll2check="LoansList" 
    			fieldNameInIcoll="loanAmount" 
    			on1Do="return" 
    			on0Do="checkLoansFieldsOpStep"/>
    	    	
    	<!-- Flow for hotsaot rishoniyot -->
    	<opStep id="compareTotalAmountsForHotsaotRishoniyotOpStep" 
    			implClass="mataf.general.operations.CompareAmmountsOpStep" 
    			fieldName2check="HotsaotRishoniotLoanAmmount" 
    			fieldNameToCmpr="TotalAmount" 
    			setErrorInField="false" 
    			comparisonType="3" 
    			errorNo="TL610" 
    			on1Do="return" />
    	<opStep id="prepareLoansDataForHotsaotRishoniyotOpStep" 
    			implClass="mataf.slika.operations.PrepareLoansDataForHotsaotRishoniyotOpStep"
    			on1Do="return" />
    	
    	<!-- Flow for hotsaot rishoniyot and takbulim -->
    	<opStep id="checkLoansFieldsOpStep" 
    			implClass="mataf.slika.operations.CheckLoansFieldsOpStep" 
    			on1Do="return" />
    	<opStep id="dataMapperOpStep" 
    			dataMapperName="LoansDetailsTrx_MapperFmt" 
    			on1Do="return" />
    	<opStep id="sendHostSynchronousOpStep" on1Do="return" />
    	<opStep id="hostMessageSetterOpStep" on1Do="return" />
    	
    	<opStep id="checkKodTipulXOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="X" 
    			on0Do="return" />
    	<opStep id="loansFieldsSetterServerOpStep"
    			implClass="mataf.slika.operations.LoansFieldsSetterServerOpStep" 
    			errorNo="GL908" />
    	
    	<refFormat refId="checkLoanDetailsCsReplyFmt" name="csReplyFormat"/>
		<refFormat refId="loanDetailsTrxRequestFmt" name="hostSendFormat"/>
    	<refFormat refId="loanDetailsTrxReplyFmt" name="hostReceiveFormat"/>
    	<refFormat refId="LoansDetailsTrx_MapperFmt" name="LoansDetailsTrx_MapperFmt"/>
    </operation>
    
    <operation context="slikaCtx" id="sendCheckDetailsServerOp">
		<opStep id="compareTotalAmountsOpStep" 
    			fieldName2check="TotalAmount" 
    			errorNo="TL613" 
    			icoll2check="CZSS_T110_LIST" 
    			fieldNameInIcoll="CH_SCHUM_CHEQ" 
    			on1Do="return" />
    			
    	<opStep id="numberOfChecksSetterOpStep" 
    			implClass="mataf.slika.operations.NumberOfChecksSetterOpStep"/>    	
    			
    	<opStep id="checksFillerSetterOpStep" />
    	
    	<opStep id="checkReaderPropertySetterOpStep" 
    			implClass="mataf.slika.operations.CheckReaderPropertySetterOpStep" />
    	
    	<opStep id="dataMapperOpStep" 
    			dataMapperName="SendCheckDetailsTrx_MapperFmt" 
    			on1Do="return" />    			
    	<opStep id="sendHostSynchronousOpStep" 
    			on1Do="return" />
    	<opStep id="hostMessageSetterOpStep" 
    			on1Do="return" />
    	
    	<opStep id="setChecksDataFromServerOpStep" 
    			implClass="mataf.slika.operations.SetChecksDataFromServerOpStep"
    			on1Do="return" />
    	
    	<refOpSteps refId="kodTipulKlaliFlow"/>
    	
    	<!-- tipul le kod tipul be vade netuney hamchaot le slika-->
    	<!-- check if kodTipul='X' -->
    	<opStep id="checkSlikaVadeNetunimKodTipulXOpStep"  
    			implClass="mataf.general.operations.CompareAndExitOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="X"
    			fieldToSet="CloseButton2" 
    			on1Do="return"/>
    			
    	<!-- check if kodTipul='R' -->
    	<opStep id="checkSlikaVadeNetunimKodTipulROpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="R" 
    			on0Do="return" />
    			
    	<!-- check if kodTipul='E' -->
    	<opStep id="checkSlikaVadeNetunimKodTipulEOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL"
    			value2cmpr="E"
    			on0Do="return" />
    	
    	<!-- check if kodTipul='N' -->
    	<opStep id="checkSlikaVadeNetunimKodTipulNOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL"
    			value2cmpr="N" 
    			on0Do="return" />
    			
    	<!-- check if kodTipul='M' -->
    	<opStep id="checkSlikaVadeNetunimKodTipulMOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL"
    			value2cmpr="M"
    			on0Do="setIshurMenahelOpStep" />
    			
    	<!-- check if kodTipul='A' -->
    	<opStep id="checkSlikaVadeNetunimKodTipulAOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL"
    			value2cmpr="A" 
    			on1Do="setMsgAccordingToValueHOpStep" 
    			on0Do="compareChecksSentWithChecksRecivedOpStep"/>
    	
    	<!-- Set the field that indicates that manager approval should be commited to 'true' -->		
    	<opStep id="setIshurMenahelOpStep"
    			implClass="mataf.general.operations.FieldValueSetterOpStep"
    			fieldToSet="shouldRequestIshurMenahel" 
    			valueToSet="true" />
    	    			
    	<!-- check if kodTipul='H' -->
    	<opStep id="setMsgAccordingToValueHOpStep"
    			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
    			fieldName2check="AccountNumber" 
    			errorNo="TL611" 
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="H" 
    			on0Do="compareChecksSentWithChecksRecivedOpStep" 
    			on1Do="compareChecksSentWithChecksRecivedOpStep"/>
    			
    	<!-- compare between all cheques send 2 the host with the ones in the screen -->
    	<opStep id="compareChecksSentWithChecksRecivedOpStep"  
    			implClass="mataf.general.operations.CompareIcollsOpStep"
    			icoll1name="sendCheckDetailsTrxReplyData.CZSS_T110_LIST" 
    			icoll2name="CZSS_T110_LIST"
    			fieldsNames2cmpr="CH_MISPAR_CHEQ,CH_BANK_CHOTEM,CH_SNIF_CHOTEM,CH_SNIF_S_B,CH_CH_CHOTEM" 
    			delim="," 
    			errorNo="TL612" 
    			on1Do="return"/>
    	
    	<!-- GIluy Naot -->
    	<opStep id="giluyNaotForSlikaParamsMapperOpStep"
    			implClass="mataf.general.operations.DataMapperOpStep" 
    			dataMapperName="giluyNaotForSlika_MapperFmt"
    			on1Do="return" />
    	<refOpSteps refId="giluyNaotFlow" />    	    	
    	
    	<opStep id="checkIshurMenahelInSlikaOpStep" 
    			implClass="mataf.slika.operations.CheckIshurMenahelInSlikaOpStep"
    			on1Do="return" />
    	
    	<opStep id="sendCheckDetailsSetterOpStep" 
    			implClass="mataf.slika.operations.SendCheckDetailsSetterOpStep"/>
    	
    	<refFormat refId="sendCheckDetailsCsReplyFmt" name="csReplyFormat"/>
		<refFormat refId="sendCheckDetailsTrxRequestFmt" name="hostSendFormat"/>
    	<refFormat refId="sendCheckDetailsTrxReplyFmt" name="hostReceiveFormat"/>
    	<refFormat refId="SendCheckDetailsTrx_MapperFmt" name="SendCheckDetailsTrx_MapperFmt"/>
    	<refFormat refId="giluyNaotForSlika_MapperFmt" name="giluyNaotForSlika_MapperFmt"/>
    	<refFormat refId="ManagerAprovalTrx_MapperFmt" name="ManagerAprovalTrx_MapperFmt"/>
    	<refFormat refId="managerAprovalTrxRequestFmt" name="managerAprovalTrxRequestFmt"/>
    </operation>
    
    <operation context="slikaCtx" id="acceptSlServerOp">    
    	
    	<!-- writting 2 journal and prepare data to print -->
    	<opStep id="prapereData4SlikaJournalOpStep" on1Do="return" />
    	
    	<opStep id="mutavCtxSetter4SlikaJournalOpStep" 
    			implClass="mataf.slika.journal.operations.MutavCtxSetter4SlikaJournalOpStep"
    			on1Do="return" />
    	<opStep id="setMutavDataToPrintOpStep" 
    			implClass="mataf.slika.operations.SetMutavDataToPrintOpStep"
    			on1Do="return" />
    	<opStep id="connectToJournal"/>
    	<opStep id="writeMutav2journalOpStep" 
    			implClass="mataf.general.operations.WriteToJournalOpStep" 
    			errorNo="TL641"
    			serviceName="journalService" 
    			formatName="slikaJournalFmt" 
    			on1Do="return" />
    			  			
    	<opStep id="chotemCtxSetter4SlikaJournalOpStep" 
    			implClass="mataf.slika.journal.operations.ChotemCtxSetter4SlikaJournalOpStep"
    			errorNo="TL641"
    			serviceName="journalService" 
    			formatName="slikaJournalFmt"  
    			on1Do="return" />
    	
    	<!-- Here should increase the journal counter, but this will be done after the opStep
    		 that save the slika context (class named SetContextAsBinaryOpStep) -->
    	    					
    	<opStep id="checksFillerSetterOpStep" />
    	<opStep id="dataMapperOpStep" 
    			dataMapperName="AcceptChequesTrx_MapperFmt" 
    			on1Do="return" />
    	<opStep id="sendHostSynchronousOpStep" on1Do="return"/>
    	<opStep id="hostMessageSetterOpStep" />
    	<!--opStep id="forTestOnlyOpStep" on1Do="return"
    			implClass="mataf.general.operations.FieldValueSetterOpStep"
    			fieldToSet="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" valueToSet="K" /-->
    	
    	<refOpSteps refId="kodTipulKlaliFlow"/>
    	
    	<!-- set fields 2 update according 2 kodTipul -->
    	<opStep id="firstCompareKodTipulToKOpStep" 
    			implClass="mataf.general.operations.CompareAndSetValueOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="K"
    			fieldToSet="CZSJ_REC.GL_SW_HUSHLEMA" 
    			valueToSet="1" 
    			on1Do="next" 
    			on0Do="firstCompareKodTipulToXOpStep"/>
    	<opStep id="secondCompareKodTipulToKOpStep" 
    			implClass="mataf.general.operations.CompareAndSetValueOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="K"
    			fieldToSet="CZSJ_REC.GL_SW_LVARER" 
    			valueToSet="0" 
    			on1Do="decreaseInquireCounterOpStep"/>
    	<opStep id="firstCompareKodTipulToXOpStep" 
    			implClass="mataf.general.operations.CompareAndSetValueOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="X"
    			fieldToSet="CZSJ_REC.GL_SW_HUSHLEMA" 
    			valueToSet="0" 
    			on1Do="next" 
    			on0Do="updateSlikaJournalOpStep"/>
    	<opStep id="secondCompareKodTipulToXOpStep"
    			implClass="mataf.general.operations.CompareAndSetValueOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="X"
    			fieldToSet="CZSJ_REC.GL_SW_LVARER" 
    			valueToSet="0" />
    	
    	<!-- If host updated the data sent to him properly, then we decrease the inquire counter -->		
    	<opStep id="decreaseInquireCounterOpStep"
    			implClass="mataf.general.operations.DecreaseInquireCounterOpStep"
    			errorNo="TL643" 
    			serviceName="journalService" />    	
    			    	
    	<!-- updating journal -->
    	<opStep id="updateSlikaJournalOpStep" 
    			implClass="mataf.general.operations.UpdateSlikaJournalOpStep" 
    			errorNo="TL642"
    			serviceName="journalService" 
    			formatName="slikaJournalFmt" 
    			on1Do="return" />
    	<opStep id="disconnectFromJournal"/>
    	<opStep id="checkKodTipulKOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="K" 
    			on0Do="return"/>
    	<opStep id="checkKodTipulXOpStep" 
    			implClass="mataf.general.operations.CompareValuesOpStep"
    			fieldNameToCmpr="HostHeaderReplyData.GKSR_HDR.GL_KOD_TIPUL" 
    			value2cmpr="X" 
    			on0Do="return" />
    	<opStep id="addMessage2MsgListOpStep" errorNo="GL232" />
    			
    	<refFormat refId="acceptSlCsReplyFmt" name="csReplyFormat"/>
		<refFormat refId="acceptSlTrxRequestFmt" name="hostSendFormat"/>
    	<refFormat refId="acceptSlTrxReplyFmt" name="hostReceiveFormat"/>
    	
    	<!-- mappers & formats 4 journal -->
		<refFormat refId="slikaJournalFmt" name="slikaJournalFmt"/>
		<refFormat refId="CZAJ_HDR_mapper" name="CZAJ_HDR_mapper"/>
		<refFormat refId="preSlikaJournal_mapper" name="preSlikaJournal_mapper"/>
		<refFormat refId="CZAJ_ADD_CHOTEM_MapperFmt" name="CZAJ_ADD_CHOTEM_MapperFmt"/>
		<refFormat refId="CZAJ_MKRT_MapperFmt" name="CZAJ_MKRT_MapperFmt"/>
		<refFormat refId="CZAJ_T110_MapperFmt" name="CZAJ_T110_MapperFmt"/>
		
    	<!-- mappers 4 printing -->
    	<refFormat refId="AcceptChequesTrx_MapperFmt" name="AcceptChequesTrx_MapperFmt"/>
    	<refFormat refId="CZAP_LAZER_SCM_mapper" name="CZAP_LAZER_SCM_mapper"/>
    	<refFormat refId="CZAP_LAZER_T110_mapper" name="CZAP_LAZER_T110_mapper"/>
    	<refFormat refId="CZAP_LAZER_HDR1_mapper" name="CZAP_LAZER_HDR1_mapper"/>
    	<refFormat refId="CZAP_LAZER_110_mapper" name="CZAP_LAZER_110_mapper"/>
    	<refFormat refId="CZAP_LAZER_T110_HALV_mapper" name="CZAP_LAZER_T110_HALV_mapper"/>
    	<refFormat refId="CZAP_T110_SNIF_mapper" name="CZAP_T110_SNIF_mapper"/>
    	<refFormat refId="CZAP_LAZER_T110_ASM_mapper" name="CZAP_LAZER_T110_ASM_mapper"/>
    	<refFormat refId="CZAP_T110_CH_RTRN_mapper" name="CZAP_T110_CH_RTRN_mapper"/>
    	<refFormat refId="CZAP_T110_CH_RTRN_PG_mapper" name="CZAP_T110_CH_RTRN_PG_mapper"/>
    </operation>
    
    <operation context="slikaCtx" id="saveContextInJournalServerOp">    
    	<opStep id="prapereData4SlikaJournalOpStep" on1Do="return" />
    	<opStep id="dataMapperOpStep" 
    			dataMapperName="contextRecordInJournal_mapper" 
    			on1Do="return" />
    	<opStep id="setContextAsBinaryOpStep" 
    			implClass="mataf.general.operations.SetContextAsBinaryOpStep" 
    			errorNo="TL641" 
    			on1Do="return" />
    	<opStep id="connectToJournal"/>
    	<opStep id="writeContext2journalOpStep" 
    			implClass="mataf.general.operations.WriteToJournalOpStep" 
    			errorNo="TL641"
    			serviceName="journalService" 
    			formatName="slikaJournalFmt" 
    			on1Do="return"/>
    	
    	<opStep id="increaseJournalCountersOpStep" 
    			implClass="mataf.general.operations.IncreaseJournalCountersOpStep"
    			serviceName="journalService" 
    			formatName="slikaJournalFmt"
    			errorNo="TL643"	
    			on1Do="return"/>
    	
    	<opStep id="disconnectFromJournal"/>		    	    	
    	
    	<refFormat refId="acceptSlCsReplyFmt" name="csReplyFormat"/>
    	<refFormat refId="preSlikaJournal_mapper" name="preSlikaJournal_mapper"/>
    	<refFormat refId="contextRecordInJournal_mapper" name="contextRecordInJournal_mapper"/>
    	<refFormat refId="CZAJ_HDR_mapper" name="CZAJ_HDR_mapper"/>
    </operation> 	
    
    <operation context="overrideCtx" id="overrideReplyServerOp" implClass="mataf.override.OverrideReplyServerOp" />
    <operation context="overrideCtx" id="overrideReqServerOp" implClass="mataf.override.OverrideReqServerOp" />
    <operation context="overrideCtx" id="overrideCancelServerOp" implClass="mataf.override.OverrideCancelSrvOp" />
    <operation context="overrideCtx" id="openOverrideServerOp" implClass="mataf.override.OpenOverrideSrvOp" />
    
	<!-- Journal wrap server operation -->
    <operation context="journalWrapCtx" id="journalWrapSrvOp" implClass="mataf.services.electronicjournal.JournalWrapSrvOp" />
	<!--=========================================================================-->
	<!-- K86P server operations                           			             -->
	<!--=========================================================================-->
	<operation id="initHalbanatHonServerOp" context="halbanathonCtx" >
		<opStep id="checkIsHalbanatHonNeededForAccountOpStep" errorNo="GL162" on1Do="exitFromHalbanatHonOpStep" />
		<opStep id="checkIsBankaiOpStep" 				implClass="mataf.halbanathon.operations.CheckIsBankaiOpStep" />
		<opStep id="firstCheckInDecisionTableOpStep" 	implClass="mataf.halbanathon.operations.CheckInDecisionTableOpStep" msgTableId="runtimeMsgs" errorNo="GL499" on1Do="exitFromHalbanatHonOpStep" />
		<opStep id="copyFieldsToScreenOpStep" 			implClass="mataf.halbanathon.operations.CopyFieldsToScreenOpStep" />
		<opStep id="H13" 								implClass="mataf.halbanathon.operations.H13" />
		<opStep id="H14" 								implClass="mataf.halbanathon.operations.H14" on1Do="exitFromHalbanatHonOpStep" />
		<opStep id="H15" 								implClass="mataf.halbanathon.operations.H15" />
		<opStep id="H16" 								implClass="mataf.halbanathon.operations.H16" msgTableId="runtimeMsgs" errorNo="GL161" />
		<opStep id="halbanatHonPreDisplayScreenOpStep"  implClass="mataf.halbanathon.operations.HalbanatHonPreDisplayScreenOpStep" on0Do="return"/>
		<opStep id="exitFromHalbanatHonOpStep" 			implClass="mataf.halbanathon.operations.ExitFromHalbanatHonOpStep" />

		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>
	
	<operation id="halbanatHonTnay2ServerOp" context="emptyCtx" implClass="mataf.halbanathon.operations.HalbanatHonTnay2ServerOp" />
	<operation id="halbanatHonTnay3ServerOp" context="emptyCtx" implClass="mataf.halbanathon.operations.HalbanatHonTnay3ServerOp" />
	<operation id="halbanatHonTnay4ServerOp" context="emptyCtx"  implClass="mataf.halbanathon.operations.HalbanatHonTnay4ServerOp" />
	<operation id="halbanatHonTnay12ServerOp" context="emptyCtx" implClass="mataf.halbanathon.operations.HalbanatHonTnay12ServerOp" />
	<operation id="halbanatHonTnay41ServerOp" context="emptyCtx"  implClass="mataf.halbanathon.operations.HalbanatHonTnay41ServerOp" />
	<operation id="halbanatHonTnay42ServerOp" context="emptyCtx"  implClass="mataf.halbanathon.operations.HalbanatHonTnay42ServerOp" />
	
	<operation id="halbanatHonSugLakoachServerOp" context="halbanathonCtx" implClass="mataf.halbanathon.operations.HalbanatHonSugLakoachServerOp">

		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>

	<operation id="halbanatHonSugCheshbonAcherServerOp" context="halbanathonCtx" implClass="mataf.halbanathon.operations.HalbanatHonSugCheshbonAcherServerOp">	
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>
	
	<operation id="halbanatHonAccountAcherServerOp" context="halbanathonCtx" implClass="mataf.halbanathon.operations.HalbanatHonAccountAcherServerOp">	
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>
	
	<operation id="halbanatHonTransmitSugLakoachServerOp"
		context="halbanathonCtx">
		<refFormat refId="HAAI_PRT_CHEL_SHIDUR"
			name="HAAI_PRT_CHEL_SHIDUR_mapFormat" />
		<refFormat refId="HAAI_PRT_MALE_SHIDUR"
			name="HAAI_PRT_MALE_SHIDUR_mapFormat" />
		<refFormat refId="HAAI_INQ_SHIDUR" name="HAAI_INQ_SHIDUR_mapFormat" />
		<refFormat refId="halbanatHonTrxRequestFmt" name="hostSendFormat" />
		<refFormat refId="halbanatHonTrxReplyFmt" name="hostReceiveFormat" />
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
		
		<opStep id="preparePirteyLakoach"
			implClass="mataf.halbanathon.operationsteps.PreparePirteyLakoach"
			on1Do="exitFromHalbanatHonOpStep" />			
		<opStep id="sendHostSynchronousOpStep" on1Do="return" />
		<opStep id="hostMessageSetterOpStep" on1Do="exitFromHalbanatHonOpStep"/>
		<refOpSteps refId="kodTipulKlaliFlow"/>
		
		<opStep id="checkKodTipulX" dataElementA="*.GL_KOD_TIPUL" const="X"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="exitFromHalbanatHonOpStep" onFalse="next" />
			
		<opStep id="checkKodTipulS"
			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
			errorNo="GL157"
			fieldNameToCmpr="*.GL_KOD_TIPUL" value2cmpr="S"
			on1Do="exitFromHalbanatHonOpStep" on0Do="next" />
			
		<opStep id="checkKodTipulM" dataElementA="*.GL_KOD_TIPUL" const="M"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="managerApproval" onFalse="next" />
			
		<opStep id="checkKodTipulK" dataElementA="*.GL_KOD_TIPUL" const="K"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="reportAllreadyExistWithValue0" onFalse="next" />
			
		<opStep id="checkKodTipulH" dataElementA="*.GL_KOD_TIPUL" const="H"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="reportAllreadyExistWithValue0"
			onFalse="next" />
			
		<opStep id="handleOtherKodTipul"
			implClass="mataf.common.operationsteps.SetMessageAndOrValue"
			errorNo="GL319"
			dataElementName="GLSX_K86P_RESULT.HA_SW_DIVUACH_BUTZA" dataValue="2"
			on0Do="exitFromHalbanatHonOpStep" />
			
		<opStep id="reportAllreadyExistWithValue0"
			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
			errorNo="GL272"
			fieldNameToCmpr="*.HA_DIVUACH_KAYAM" value2cmpr="0"
			on1Do="exitFromHalbanatHonOpStep" on0Do="next" />
			
		<opStep id="reportAllreadyExistWithValue1"
			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
			errorNo="GL148"
			fieldNameToCmpr="*.HA_DIVUACH_KAYAM" value2cmpr="1"
			on1Do="return" on0Do="next" />
			
		<opStep id="reportAllreadyExistWithValue2"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"			
			dataElementA="*.HA_DIVUACH_KAYAM" const="2"
			operator="equal" onTrue="next" onFalse="exitFromHalbanatHonOpStep" />
			
		<refOpSteps refId="resendSugLakoachFlow"/>
		
		<opStep id="managerApproval"
			implClass="mataf.halbanathon.operations.SetIshurMenahel" 
			on0Do="return"
			on1Do="exitFromHalbanatHonOpStep"/>
		
	</operation>

	<operation id="dispatchSugLakoachAgain" context="halbanathonCtx">
		<refFormat refId="HAAI_PRT_CHEL_SHIDUR"
			name="HAAI_PRT_CHEL_SHIDUR_mapFormat" />
		<refFormat refId="HAAI_PRT_MALE_SHIDUR"
			name="HAAI_PRT_MALE_SHIDUR_mapFormat" />
		<refFormat refId="HAAI_INQ_SHIDUR" name="HAAI_INQ_SHIDUR_mapFormat" />
		<refFormat refId="halbanatHonTrxRequestFmt" name="hostSendFormat" />
		<refFormat refId="halbanatHonTrxReplyFmt" name="hostReceiveFormat" />		
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
		
		<opStep id="preparePirteyLakoach"
			implClass="mataf.halbanathon.operationsteps.PreparePirteyLakoach"
			on1Do="exitFromHalbanatHonOpStep" />
			
		<opStep id="reportAllreadyExistWithValue1"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"		
			dataElementA="HASR_PRATIM_SHIDUR.HA_DIVUACH_KAYAM" const="1"
			operator="equal" onTrue="next" onFalse="resendSugLakoachFlow" />
			
		<opStep id="handleOtherKodTipul"
			implClass="mataf.common.operationsteps.SetMessageAndOrValue"
			dataElementName="HASI_PRATIM_SHIDUR.HA_DRISAT_DIVUACH" dataValue="1"
			on0Do="next"
			on1Do="exitFromHalbanatHonOpStep" />
			
		<refOpSteps refId="resendSugLakoachFlow"/>
		
		<opStep id="exitFromHalbanatHonOpStep"
			implClass="mataf.halbanathon.operations.ExitFromHalbanatHonOpStep"
			on0Do="return" />
	</operation>
	
	<opStepsKColl id="resendSugLakoachFlow">
    	<opStep id="setValueBeforeResend"
    		implClass="mataf.common.operationsteps.SetMessageAndOrValue"
			dataElementName="HASI_PRATIM_SHIDUR.HA_DRISAT_DIVUACH" dataValue="1"
			on0Do="sendHostSynchronousOpStep" />
		<opStep id="sendHostSynchronousOpStep" on1Do="return" />
		<opStep id="hostMessageSetterOpStep" />
		<refOpSteps refId="kodTipulKlaliFlow" />
		
		<opStep id="checkKodTipulKAgain" dataElementA="*.GL_KOD_TIPUL" const="K"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="exitFromHalbanatHonOpStep" onFalse="next" />
		<opStep id="checkKodTipulHAgain" dataElementA="*.GL_KOD_TIPUL" const="H"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="exitFromHalbanatHonOpStep" onFalse="next" />
		<opStep id="exitFromHalbanatHonOpStep"
			implClass="mataf.halbanathon.operations.ExitFromHalbanatHonOpStep"
			on0Do="return" />
    </opStepsKColl>
	
	<!-- ==================== PRATIM SCREEN SERVER OPERATIONS ===================== -->
	
	<operation id="halbanatHonDetailsServerOp" context="halbanathonCtx" implClass="mataf.halbanathon.operations.HalbanatHonDetailsServerOp">	
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>
	
	<operation id="halbanatHonCountriesServerOp" context="halbanathonCtx" implClass="mataf.halbanathon.operations.HalbanatHonCountriesServerOp">	
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>
	
	<operation id="halbanatHonIDServerOp" context="halbanathonCtx">	
		<opStep id="halbanatHonCheckIDOpStep" on1Do="return" implClass="mataf.halbanathon.operations.HalbanatHonCheckIDOpStep" />
		
		<opStep id="halbanatHonCheckID2OpStep" 
				implClass="mataf.halbanathon.operations.HalbanatHonCheckID2OpStep"
				errorNo="GL159"
				on1Do="return" on2Do="halbanatHonCallTransmitionOpStep" />
				
		<opStep id="halbanatHonSearchOperationOpStep" on1Do="return" implClass="mataf.halbanathon.operations.HalbanatHonSearchOperationOpStep" />
		<opStep id="halbanatHonCallTransmitionOpStep" on2Do="return" implClass="mataf.halbanathon.operations.HalbanatHonCallTransmitionOpStep" />
		
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>
	
	<operation id="halbanatHonTransmitDetailsServerOp" context="halbanathonCtx" >
		<refFormat refId="HAAI_MIZD_PRATIM_mapper" name="HAAI_MIZD_PRATIM_mapFormat" />
		<refFormat refId="HAAI_INQ_SHIDUR" name="HAAI_INQ_SHIDUR_mapFormat" />
		<refFormat refId="lakoachMizdamTrxRequestFmt" name="hostSendFormat" />
		<refFormat refId="lakoachMizdamTrxReplyFmt" name="hostReceiveFormat" />
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
		
		<opStep id="preparePirteyLakoachMizdamen"
			implClass="mataf.halbanathon.operationsteps.PreparePirteyLakoachMizdamen"
			on0Do="next" on1Do="return"/>
		<opStep id="sendHostSynchronousOpStep" on1Do="return" />
		<opStep id="hostMessageSetterOpStep" />		
		<refOpSteps refId="kodTipulKlaliFlow" />
				
		<opStep id="checkKodTipulX" dataElementA="*.GL_KOD_TIPUL" const="X"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="exitFromHalbanatHonOpStep" onFalse="next" />
			
		<opStep id="checkKodTipulM" dataElementA="*.GL_KOD_TIPUL" const="M"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="managerApproval" onFalse="next" />
			
		<opStep id="checkKodTipulK" dataElementA="*.GL_KOD_TIPUL" const="K"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="shederOK" onFalse="next" />
			
		<opStep id="checkKodTipulH" dataElementA="*.GL_KOD_TIPUL" const="H"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="shederOK"
			onFalse="shederNotOk" />
			
		<!-- there is no design for this opstep allthough there is a call to it -->
		<opStep id="shederOK"
			implClass="mataf.halbanathon.operations.ExitFromHalbanatHonOpStep"
			on0Do="return" />
			
		<opStep id="shederNotOk"
			implClass="mataf.general.operations.SetMsgAccordingToValueOpStep"
			errorNo="GL155"
			fieldNameToCmpr="HASR_MIZDAMEN_PRATIM.KESHER_LE_MALAM" value2cmpr="0"
			on1Do="return" on0Do="next" />
		
		<opStep id="checkMizdamenChadash" dataElementA="HASR_MIZDAMEN_PRATIM.HA_MIZDAMEN_CHADASH" const="1"
			implClass="mataf.common.operationsteps.CompareAssertionAndConstants"
			operator="equal" onTrue="setValueInMizdamenChadash"
			onFalse="exitFromHalbanatHonOpStep" />
		
		<opStep id="setValueInMizdamenChadash"
			implClass="mataf.common.operationsteps.SetMessageAndOrValue"
			errorNo="GL145"
			dataElementName="HASX_PIRTEY_CHESHBON.HA_MIZDAMEN_CHADASH" dataValue="1"
			on0Do="checkDecisionTable" />
			
		<opStep id="checkDecisionTable"
			implClass="mataf.halbanathon.operationsteps.CheckDecisionTable"
			on0Do="return" on1Do="exitFromHalbanatHonOpStep" on2Do="setGL155Error"/>
			
		<opStep id="setGL155Error"
			implClass="mataf.common.operationsteps.SetMessageAndOrValue"
			errorNo="GL155"
			on0Do="return" />

		<opStep id="managerApproval"
			implClass="mataf.halbanathon.operations.SetIshurMenahel" 
			on0Do="return"
			on1Do="exitFromHalbanatHonOpStep"/>
				
		<opStep id="exitFromHalbanatHonOpStep"
			implClass="mataf.halbanathon.operations.ExitFromHalbanatHonOpStep"
			on0Do="return" />
	</operation>
	
	<operation id="halbanatHonKidometServerOp" context="halbanathonCtx" implClass="mataf.halbanathon.operations.HalbanatHonKidometServerOp" >
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>
	
	<operation id="halbanatHonPhoneServerOp" context="halbanathonCtx" implClass="mataf.halbanathon.operations.HalbanatHonPhoneServerOp" >
		<refFormat refId="initHalbanatHonCsReplyFmt" name="csReplyFormat" />
	</operation>

	<!--=========================================================================-->
    <!-- Srika (T491) operations                                                  -->
    <!--=========================================================================-->
    <operation id="scanJournalServerOp" context="scanJournalCtx">
		<refFormat refId="scanJournalCsReplyFmt" name="csReplyFormat" />
		<refFormat refId="scanJournalFmt" name="toJournal" />
		<refFormat refId="journalToScreenMapping" name="journalToScreen" />
		
		<opStep id="connectToJournal"
			on0Do="next"
			on1Do="exitWithError"/>
			
		<opStep id="buildStatement"
			implClass="mataf.srika.operationsteps.BuildStatement" 
			on0Do="next"
			on1Do="exitWithError"/>		
			
		<opStep id="scanJournal"
			implClass="mataf.srika.operationsteps.ScanJournal"
			on0Do="next"
			on1Do="exitWithError"/>
			
		<opStep id="buildReply"
			implClass="mataf.srika.operationsteps.BuildReply"
			on0Do="next"
			on1Do="exitWithError"/>
			
		<opStep id="disconnectFromJournal"
			on0Do="return"
			on1Do="exitWithError"/>
			
		<opStep id="exitWithError"
			implClass="mataf.srika.operationsteps.ExitWithError" 
			on0Do="return"/>
	</operation>
	
	<operation id="restoreContextServerOp" context="srikaRestoreCtx">
		<refFormat refId="srikaRestoreCsReplyFmt" name="csReplyFormat" />
		
		<opStep id="connectToJournal"/>
		
		<opStep id="restoreContextOpStep" implClass="mataf.srika.operationsteps.RestoreContextOpStep" 
				fieldToSet="contextAsBinary" errorNo="TL641"/>
				
		<opStep id="disconnectFromJournal"/>
	</operation>
	
	<!--=========================================================================-->
    <!-- Transactions validations operations                                     -->
    <!--=========================================================================-->
    <operation id="checkConnectionToHostServerOp" context="validatorCtx">
		<refFormat refId="checkConnectionToHostReplyFmt" name="csReplyFormat" />
		<opStep id="checkConnectionToHost" implClass="mataf.common.operationsteps.CheckConnectionToHost" />
	</operation>

	<!--/DWGroupDef-->
</dseoper.xml>