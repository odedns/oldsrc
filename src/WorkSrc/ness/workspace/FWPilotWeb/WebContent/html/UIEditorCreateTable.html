<html>
<head>
<script>
function initTable()
{
	for (i = 1;i < 101;i++) 
	{
		rows.add(new Option(i,i));
	}
	for (i = 1;i < 21;i++) 
	{
		cols.add(new Option(i,i));
	}
	document.body.dir = window.dialogArguments[0];
	document.all.approveButton.value = window.dialogArguments[1];
	document.all.cancelButton.value = window.dialogArguments[2];
	document.all.rowLabel.innerText = window.dialogArguments[3];
	document.all.colLabel.innerText = window.dialogArguments[4];
}

function checkOut()
{
	if (window.returnValue == null) 
	{
		window.returnValue = "";
	}
}

function approve()
{
	table1.height = "1%";
	table1.width = "1%";
	window.returnValue = htmlTable.innerHTML;
	self.close();
}

function writeHtmlTable()
{
	var html = "<table id=table1 border=1>";
	for (i = 1;i <= rows.value;i++) 
	{
		html += "<tr>";
		for (j = 1;j <= cols.value;j++) 
		{
			html += "<td>&nbsp;</td>";
		}
		html += "</tr>";
	}
	html += "</table>";
	htmlTable.innerHTML = html;
	table1.width = "100%";
	table1.height = "100%";
}
</script>
<link href="../theme/system.css" rel="stylesheet" type="text/css">
</head>
<body class="bodyDialog" onload="initTable()" onUnload="checkOut()">
<table align=center>
<tr>
	<td>
		<table>
			<tr>
			<td nowrap id="rowLabel">row</td>
			<td><select name="rows" onchange="writeHtmlTable()"></select></td>
			<td nowrap id="colLabel">col</td>
			<td><select name="cols" onchange="writeHtmlTable()"></select></td>
			</tr>
		</table>
	</td>
</tr>
<tr>
	<td>
		<div id="htmlTable">
			<table id=table1 width="100%" height="100%" border="1">
			<tr><td>&nbsp</td></tr>
			</table>
		</div>
	</td>
</tr>
<tr>
	<td>
		<table align=center>
		<tr>
		<td>
		<input type="button" id="approveButton" class="buttonEnabled" onclick="approve()">
		<input type="button" id="cancelButton" class="buttonEnabled" onclick="returnValue='';self.close()">
		</td>
		</tr>
		</table>
	</td>
</tr>
</table>
</body>
</html>
