<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root SYSTEM "flower.dtd">
<root>	
	<buttonSet name="csBS">
		<button name="close" eventName="close" group="left" checkDirtyFlag="true"/>
		<button name="save" eventName="save" group="left" checkDirtyFlag="false" allowEventOnDirtyIds="false"/>
	</buttonSet>

	<context name="customersCTX">
		<field name="customerManager" type="fwpilot.customer.vo.CustomerManager"/>
		<field name="customersTable" type="tableModel"/>

		<field name="customerName" type="xiString"/>
		<field name="customerFamily" type="xiString"/>


	</context>
	
	<operationDefinition name="PLInitCustomersOP" class="fwpilot.managment.customer.PLInitCustomersOP"/>
	<operationDefinition name="PLNewCustomerOP"  activityType="readWrite" class="fwpilot.managment.customer.PLNewCustomerOP"/>
	<operationDefinition name="PLUpdateCustomerOP"  activityType="readWrite" class="fwpilot.managment.customer.PLUpdateCustomerOP"/>
	<operationDefinition name="PLDeleteCustomerOP"  activityType="readWrite" class="fwpilot.managment.customer.PLDeleteCustomerOP"/>
	<operationDefinition name="PLLoadCustomer"  activityType="readOnly" class="fwpilot.managment.customer.PLLoadCustomerOP"/>
	<operationDefinition name="PLSaveCustomersOP"  activityType="readOnly" class="fwpilot.managment.customer.PLSaveCustomerOP"/>

	<!-- ============================================================ -->
	<!-- Search customer flow -->
	<!-- ============================================================ -->
	<flow name="customersFlow" context="customersCTX">	
		<!-- The initial state of the flow. Init the models-->
		<state name="initState" type="simple" initial="true">
			<entryActions>
				<action type="operation" refName="PLInitCustomersOP"/>			
			</entryActions>
			<transition targetState="dispatchState" default="true">
			</transition>	
 		</state> 
  		
		<state name="dispatchState" type="simple">
			<transition targetState="viewState"  default="true">
				<actions>
	                <action type="operation" refName="PLLoadCustomer"/>
		        </actions> 
			</transition>
		</state>

		<state name="viewState" type="complex" page="app\customer\jsp\customers.jsp" buttonSet="csBS">			
		
			<transition event="close" targetState="finalScreen"></transition>										
			<transition event="customersTable|selection" targetState="dispatchState"/>
			<transition event="new" targetState="dispatchState">
				<actions>
	                <action type="operation" refName="PLNewCustomerOP" />
		        </actions>
			</transition>
	
			<transition event="delete" targetState="dispatchState">
				<actions>
	                <action type="operation" refName="PLDeleteCustomerOP" />
		        </actions>
			</transition>
	
			<transition  event="update" targetState="dispatchState">
				<actions>
		            <action type="operation" refName="PLUpdateCustomerOP" />
		        </actions>
			</transition>

			<transition event="save" internal="true">
				<actions>
					<action type="operation" refName="PLSaveCustomersOP"/>
				</actions>
			</transition>
		</state>
		
		<state name="finalScreen" type="final"/>
		 
	</flow>
			
 </root>